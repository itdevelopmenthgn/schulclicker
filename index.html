<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bildungs-Clicker</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: sans-serif;
      background:#1a1a2e;
      color:#eee;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:20px;
      margin:0;
      max-width:100vw;
      overflow-x:hidden;
    }
    h1 {
      color:#4a90e2;
      font-size:1.8rem;
      text-align:center;
      margin:10px 0;
    }
    h2 {
      font-size:1.3rem;
      text-align:center;
      margin:15px 0 10px 0;
    }
    h3 {
      font-size:1.1rem;
      margin:10px 0;
      text-align:center;
    }
    p {
      margin:8px 0;
      text-align:center;
    }
    #langSelect {
      margin:10px;
      padding:12px 16px;
      background:#16213e;
      color:#eee;
      border:1px solid #4a90e2;
      border-radius:8px;
      font-size:1rem;
      min-height:44px;
      cursor:pointer;
    }
    #nameInput {
      margin:10px;
      padding:12px 16px;
      background:#16213e;
      color:#eee;
      border:1px solid #4a90e2;
      border-radius:8px;
      font-size:1rem;
      min-width:200px;
      max-width:90vw;
      text-align:center;
      min-height:44px;
    }
    #counter {
      font-size:2.5rem;
      margin:15px;
      text-align:center;
      font-weight:bold;
      color:#4a90e2;
    }
    #prestigeCounter {
      font-size:1.2rem;
      margin:10px;
      text-align:center;
      color:#ffaa00;
      font-weight:bold;
    }
    button {
      padding:12px 24px;
      font-size:1rem;
      cursor:pointer;
      background:#4a90e2;
      color:white;
      border:none;
      border-radius:12px;
      flex-shrink:0;
      min-height:44px;
      min-width:44px;
      transition: background 0.2s;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }
    button:active {
      background:#357abd;
    }
    button:disabled {
      background:#555;
      cursor:not-allowed;
    }
    button.prestige {
      background:#ffaa00;
      color:#000;
      font-weight:bold;
      font-size:1.1rem;
      padding:16px 32px;
    }
    button.prestige:active {
      background:#dd8800;
    }
    button.prestige:disabled {
      background:#555;
      color:#888;
    }
    #updaterRow {
      display:flex;
      gap:20px;
      margin-top:20px;
      flex-wrap:wrap;
      justify-content:center;
      width:100%;
      max-width:1400px;
    }
    .updaterBlock {
      display:flex;
      flex-direction:column;
      gap:10px;
      min-width:250px;
      flex:1;
    }
    .updaterBlock.hidden {
      display:none;
    }
    .upgrader {
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:#16213e;
      padding:12px 15px;
      border-radius:12px;
      gap:10px;
    }
    .upgrader.hidden {
      display:none;
    }
    .upgrader span {
      flex:1;
      word-wrap:break-word;
      font-size:0.9rem;
      line-height:1.4;
    }
    .upgrader .level {
      color:#ffaa00;
      font-weight:bold;
      font-size:0.85rem;
      margin-right:8px;
    }
    .upgrader button {
      flex-shrink:0;
      white-space: normal;
      line-height: 1.2;
      padding: 8px 12px;
      min-width: 80px;
    }
    #meters {
      display:flex;
      gap:10px;
      margin:15px;
      flex-wrap:wrap;
      justify-content:center;
    }
    .meterbox {
      background:#16213e;
      padding:10px 15px;
      border-radius:12px;
      min-width:120px;
      text-align:center;
      font-size:0.95rem;
    }
    #rank {
      margin-top:15px;
      font-size:1.2rem;
      color:#4a90e2;
      text-align:center;
      padding:0 10px;
    }
    #clickRow {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      margin-bottom:15px;
    }
    #clickBtn {
      font-size:1.1rem;
      padding:16px 32px;
      font-weight:bold;
    }
    #achievement {
      margin:20px 10px;
      padding:15px;
      background:#4a90e2;
      border-radius:12px;
      font-weight:bold;
      max-width:500px;
      text-align:center;
      display:none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    #prestigeShop {
      margin:20px 0;
      padding:20px;
      background:#2a2a3e;
      border-radius:12px;
      max-width:800px;
      width:100%;
    }
    #prestigeShop.hidden {
      display:none;
    }
    .prestigeUpgrade {
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:#16213e;
      padding:12px 15px;
      margin:10px 0;
      border-radius:12px;
      gap:10px;
    }
    .prestigeUpgrade span {
      flex:1;
      color:#ffaa00;
    }

    /* Tablet optimization */
    @media (max-width: 768px) {
      body { padding:15px 10px; }
      h1 { font-size:1.5rem; }
      h2 { font-size:1.2rem; }
      h3 { font-size:1rem; }
      #counter { font-size:2rem; }
      .updaterBlock { min-width:200px; }
      #updaterRow { gap:15px; }
    }

    /* Mobile optimization */
    @media (max-width: 600px) {
      body { padding:10px 8px; }
      h1 { font-size:1.3rem; margin:8px 0; }
      h2 { font-size:1.1rem; margin:12px 0 8px 0; }
      h3 { font-size:0.95rem; }
      p { font-size:0.9rem; }
      #counter { font-size:2.2rem; margin:10px; }
      #langSelect, #nameInput {
        width:100%;
        max-width:100%;
        margin:8px 0;
      }
      button {
        font-size:0.95rem;
        padding:12px 20px;
      }
      #clickBtn {
        width:100%;
        max-width:300px;
        padding:16px 24px;
        font-size:1rem;
      }
      #updaterRow {
        flex-direction: column;
        gap:12px;
        margin-top:15px;
      }
      .updaterBlock {
        width:100%;
        min-width:unset;
      }
      .upgrader {
        flex-direction: column;
        padding:10px 12px;
        gap:8px;
        align-items:stretch;
      }
      .upgrader span {
        font-size:0.85rem;
        text-align:center;
      }
      .upgrader button {
        padding:8px 12px;
        font-size:0.85rem;
        width:100%;
        white-space: normal;
        line-height: 1.2;
        min-width: 70px;
      }
      #meters {
        width:100%;
        gap:8px;
        margin:10px 0;
      }
      .meterbox {
        flex:1;
        min-width:100px;
        padding:8px 10px;
        font-size:0.85rem;
      }
      #rank {
        font-size:1rem;
        margin-top:10px;
      }
      #achievement {
        margin:15px 5px;
        padding:12px;
        font-size:0.9rem;
      }
    }

    /* Small mobile devices */
    @media (max-width: 400px) {
      body { padding:8px 5px; }
      h1 { font-size:1.2rem; }
      #counter { font-size:1.8rem; }
      #meters {
        flex-direction:column;
      }
      .meterbox {
        width:100%;
      }
    }
  </style>
</head>
<body>
  <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-bottom:10px;">
    <select id="langSelect">
      <option value="de">Deutsch</option>
      <option value="en">English</option>
    </select>

    <select id="difficultySelect">
      <option value="baby">Baby</option>
      <option value="easy">Leicht / Easy</option>
      <option value="medium" selected>Mittel / Medium</option>
      <option value="hard">Schwer / Hard</option>
    </select>
  </div>

  <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-bottom:15px;">
    <button id="saveBtn" style="background:#28a745;">ðŸ’¾ Speichern</button>
    <button id="loadBtn" style="background:#17a2b8;">ðŸ“‚ Laden</button>
    <button id="exportBtn" style="background:#ffc107; color:#000;">ðŸ“‹ Code Exportieren</button>
    <button id="importBtn" style="background:#fd7e14;">ðŸ“¥ Code Importieren</button>
  </div>

  <h1 id="title">Bildungs-Clicker</h1>
  <p id="flavour">Spielerisches Lernen und Lehren</p>

  <input type="text" id="nameInput" placeholder="Dein Name..." maxlength="20">

  <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin:10px 0;">
    <span style="color:#4a90e2; font-weight:bold;" id="buyAmountLabel">Kaufen:</span>
    <button id="buy1" style="background:#16213e; min-width:50px;">x1</button>
    <button id="buy5" style="background:#16213e; min-width:50px;">x5</button>
    <button id="buy10" style="background:#16213e; min-width:50px;">x10</button>
  </div>

  <div id="counter">0</div>
  <div id="prestigeCounter">Prestige-Punkte: 0</div>
  <div style="display:flex; gap:15px; justify-content:center; flex-wrap:wrap; margin:10px;">
    <div class="meterbox" style="background:#2a2a3e;">
      <span id="perClickLabel">Pro Klick</span>: <span id="perClickDisplay">1</span>
    </div>
    <div class="meterbox" style="background:#2a2a3e;">
      <span id="perSecLabel">Pro Sekunde</span>: <span id="perSecDisplay">0</span>
    </div>
  </div>

  <div style="margin:15px 0; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
    <input type="text" id="cheatInput" placeholder="Cheat-Code..." maxlength="20" style="padding:12px; background:#16213e; color:#eee; border:1px solid #4a90e2; border-radius:8px; min-width:150px; text-align:center;">
    <button id="cheatBtn" style="background:#dc3545;">ðŸŽ® Code eingeben</button>
  </div>

  <div id="clickRow">
    <button id="clickBtn">Lerne!</button>
    <button id="resetBtn" class="prestige">Reset (10M)</button>
  </div>

  <h2 id="roleTitle">Rolle wÃ¤hlen</h2>
  <button id="chooseTeacher">Ich bin Lehrer/in</button>
  <button id="chooseStudent">Ich bin SchÃ¼ler/in</button>
  <p id="roleText">Keine Rolle gewÃ¤hlt.</p>

  <div id="meters">
    <div class="meterbox"><span id="teacherLabel">Kompetenz</span>: <span id="teacherMeter">0</span></div>
    <div class="meterbox"><span id="studentLabel">Wissen</span>: <span id="studentMeter">0</span></div>
  </div>

  <div id="rank">Rang: AnfÃ¤nger</div>
  <div id="achievement"></div>

  <div id="prestigeShop" class="hidden">
    <h2>Prestige-Shop</h2>
    <div class="prestigeUpgrade">
      <span>Klick-Multiplikator x2 (Kosten: <span id="pClickCost">1</span>)</span>
      <button id="pClickBtn">Kaufen</button>
    </div>
    <div class="prestigeUpgrade">
      <span>Auto-Multiplikator x2 (Kosten: <span id="pAutoCost">1</span>)</span>
      <button id="pAutoBtn">Kaufen</button>
    </div>
    <div class="prestigeUpgrade">
      <span id="pPointsLabel">+1 Prestigepunkt (Kosten: <span id="pPointsCost">2</span>)</span>
      <button id="pPointsBtn">Kaufen</button>
    </div>
    <div class="prestigeUpgrade">
      <span>Kosten-Reduktion (Kosten: <span id="pDiscountCost">3</span>)</span>
      <button id="pDiscountBtn">Kaufen</button>
    </div>
  </div>

  <div id="updaterRow">
    <div class="updaterBlock" id="blockBasics">
      <h3 id="basicsTitle">Grundwissen</h3>
      <div class="upgrader" id="basic1"><span><span class="level" id="basic1Level">[0]</span><span id="basic1Text">Lesen lernen (+1/Klick) â€“ <span id="basic1Cost">50</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic2"><span><span class="level" id="basic2Level">[0]</span><span id="basic2Text">Schreiben Ã¼ben (+2/Klick) â€“ <span id="basic2Cost">200</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic3"><span><span class="level" id="basic3Level">[0]</span><span id="basic3Text">Rechnen Ã¼ben (+3/Klick) â€“ <span id="basic3Cost">500</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic4"><span><span class="level" id="basic4Level">[0]</span><span id="basic4Text">Vokabeln lernen (+5/Klick) â€“ <span id="basic4Cost">1000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic5"><span><span class="level" id="basic5Level">[0]</span><span id="basic5Text">Grammatik verstehen (+7/Klick) â€“ <span id="basic5Cost">2000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic6"><span><span class="level" id="basic6Level">[0]</span><span id="basic6Text">Formeln lernen (+10/Klick) â€“ <span id="basic6Cost">4000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic7"><span><span class="level" id="basic7Level">[0]</span><span id="basic7Text">ZusammenhÃ¤nge erkennen (+14/Klick) â€“ <span id="basic7Cost">8000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic8"><span><span class="level" id="basic8Level">[0]</span><span id="basic8Text">Konzepte verstehen (+20/Klick) â€“ <span id="basic8Cost">15000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic9"><span><span class="level" id="basic9Level">[0]</span><span id="basic9Text">Wissen vernetzen (+28/Klick) â€“ <span id="basic9Cost">30000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="basic10"><span><span class="level" id="basic10Level">[0]</span><span id="basic10Text">Meisterschaft (+40/Klick) â€“ <span id="basic10Cost">60000</span></span></span><button>Kaufen</button></div>
    </div>

    <div class="updaterBlock hidden" id="blockMaterials">
      <h3 id="materialsTitle">Lehrmittel</h3>
      <div class="upgrader" id="mat1"><span><span class="level" id="mat1Level">[0]</span><span id="mat1Text">ArbeitsblÃ¤tter (+1/sec) â€“ <span id="mat1Cost">500</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat2"><span><span class="level" id="mat2Level">[0]</span><span id="mat2Text">LehrbÃ¼cher (+2/sec) â€“ <span id="mat2Cost">1000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat3"><span><span class="level" id="mat3Level">[0]</span><span id="mat3Text">Ãœbungshefte (+4/sec) â€“ <span id="mat3Cost">2500</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat4"><span><span class="level" id="mat4Level">[0]</span><span id="mat4Text">Lernkarten (+7/sec) â€“ <span id="mat4Cost">5000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat5"><span><span class="level" id="mat5Level">[0]</span><span id="mat5Text">Lexikon (+11/sec) â€“ <span id="mat5Cost">10000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat6"><span><span class="level" id="mat6Level">[0]</span><span id="mat6Text">Fachliteratur (+17/sec) â€“ <span id="mat6Cost">20000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat7"><span><span class="level" id="mat7Level">[0]</span><span id="mat7Text">Bibliothek (+25/sec) â€“ <span id="mat7Cost">40000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat8"><span><span class="level" id="mat8Level">[0]</span><span id="mat8Text">Sammlung (+36/sec) â€“ <span id="mat8Cost">80000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat9"><span><span class="level" id="mat9Level">[0]</span><span id="mat9Text">Archiv (+50/sec) â€“ <span id="mat9Cost">150000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat10"><span><span class="level" id="mat10Level">[0]</span><span id="mat10Text">Universalbibliothek (+70/sec) â€“ <span id="mat10Cost">300000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat11"><span><span class="level" id="mat11Level">[0]</span><span id="mat11Text">Wissenszentrum (+100/sec) â€“ <span id="mat11Cost">600000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="mat12"><span><span class="level" id="mat12Level">[0]</span><span id="mat12Text">Omnibibliothek (+140/sec) â€“ <span id="mat12Cost">1200000</span></span></span><button>Kaufen</button></div>
    </div>

    <div class="updaterBlock hidden" id="blockExams">
      <h3 id="examsTitle">PrÃ¼fungen</h3>
      <div class="upgrader" id="exam1"><span><span class="level" id="exam1Level">[0]</span><span id="exam1Text">Tests (+2/Klick, +10/sec) â€“ <span id="exam1Cost">15000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam2"><span><span class="level" id="exam2Level">[0]</span><span id="exam2Text">Klassenarbeiten (+4/Klick, +20/sec) â€“ <span id="exam2Cost">30000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam3"><span><span class="level" id="exam3Level">[0]</span><span id="exam3Text">Klausuren (+7/Klick, +35/sec) â€“ <span id="exam3Cost">60000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam4"><span><span class="level" id="exam4Level">[0]</span><span id="exam4Text">PrÃ¼fungen (+11/Klick, +55/sec) â€“ <span id="exam4Cost">120000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam5"><span><span class="level" id="exam5Level">[0]</span><span id="exam5Text">Staatsexamen (+17/Klick, +85/sec) â€“ <span id="exam5Cost">250000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam6"><span><span class="level" id="exam6Level">[0]</span><span id="exam6Text">MeisterprÃ¼fung (+25/Klick, +125/sec) â€“ <span id="exam6Cost">500000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam7"><span><span class="level" id="exam7Level">[0]</span><span id="exam7Text">DoktorprÃ¼fung (+36/Klick, +180/sec) â€“ <span id="exam7Cost">1000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam8"><span><span class="level" id="exam8Level">[0]</span><span id="exam8Text">ProfessorenprÃ¼fung (+50/Klick, +250/sec) â€“ <span id="exam8Cost">2000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam9"><span><span class="level" id="exam9Level">[0]</span><span id="exam9Text">Akademiker-Test (+70/Klick, +350/sec) â€“ <span id="exam9Cost">4000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="exam10"><span><span class="level" id="exam10Level">[0]</span><span id="exam10Text">UniversalprÃ¼fung (+100/Klick, +500/sec) â€“ <span id="exam10Cost">8000000</span></span></span><button>Kaufen</button></div>
    </div>

    <div class="updaterBlock hidden" id="blockProjects">
      <h3 id="projectsTitle">Projekte</h3>
      <div class="upgrader" id="proj1"><span><span class="level" id="proj1Level">[0]</span><span id="proj1Text">Referat (+30/Klick, +150/sec) â€“ <span id="proj1Cost">100000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj2"><span><span class="level" id="proj2Level">[0]</span><span id="proj2Text">PrÃ¤sentation (+50/Klick, +250/sec) â€“ <span id="proj2Cost">250000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj3"><span><span class="level" id="proj3Level">[0]</span><span id="proj3Text">Gruppenarbeit (+80/Klick, +400/sec) â€“ <span id="proj3Cost">600000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj4"><span><span class="level" id="proj4Level">[0]</span><span id="proj4Text">Facharbeit (+120/Klick, +600/sec) â€“ <span id="proj4Cost">1500000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj5"><span><span class="level" id="proj5Level">[0]</span><span id="proj5Text">Forschung (+180/Klick, +900/sec) â€“ <span id="proj5Cost">3500000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj6"><span><span class="level" id="proj6Level">[0]</span><span id="proj6Text">Abschlussarbeit (+260/Klick, +1300/sec) â€“ <span id="proj6Cost">7000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj7"><span><span class="level" id="proj7Level">[0]</span><span id="proj7Text">Dissertation (+370/Klick, +1850/sec) â€“ <span id="proj7Cost">15000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj8"><span><span class="level" id="proj8Level">[0]</span><span id="proj8Text">Habilitierung (+520/Klick, +2600/sec) â€“ <span id="proj8Cost">30000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj9"><span><span class="level" id="proj9Level">[0]</span><span id="proj9Text">Lehrbuch (+720/Klick, +3600/sec) â€“ <span id="proj9Cost">60000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="proj10"><span><span class="level" id="proj10Level">[0]</span><span id="proj10Text">Lebenswerk (+1000/Klick, +5000/sec) â€“ <span id="proj10Cost">120000000</span></span></span><button>Kaufen</button></div>
    </div>

    <div class="updaterBlock hidden" id="blockDigital">
      <h3 id="digitalTitle">Digitale Tools</h3>
      <div class="upgrader" id="dig1"><span><span class="level" id="dig1Level">[0]</span><span id="dig1Text">Taschenrechner (+400/Klick, +2000/sec) â€“ <span id="dig1Cost">500000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig2"><span><span class="level" id="dig2Level">[0]</span><span id="dig2Text">Computer (+700/Klick, +3500/sec) â€“ <span id="dig2Cost">1500000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig3"><span><span class="level" id="dig3Level">[0]</span><span id="dig3Text">Lern-Apps (+1100/Klick, +5500/sec) â€“ <span id="dig3Cost">4000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig4"><span><span class="level" id="dig4Level">[0]</span><span id="dig4Text">Online-Kurse (+1700/Klick, +8500/sec) â€“ <span id="dig4Cost">10000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig5"><span><span class="level" id="dig5Level">[0]</span><span id="dig5Text">VR-Lernumgebung (+2500/Klick, +12500/sec) â€“ <span id="dig5Cost">25000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig6"><span><span class="level" id="dig6Level">[0]</span><span id="dig6Text">KI-Tutor (+3700/Klick, +18500/sec) â€“ <span id="dig6Cost">60000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig7"><span><span class="level" id="dig7Level">[0]</span><span id="dig7Text">Quantencomputer (+5300/Klick, +26500/sec) â€“ <span id="dig7Cost">150000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig8"><span><span class="level" id="dig8Level">[0]</span><span id="dig8Text">Nano-Lernchip (+7500/Klick, +37500/sec) â€“ <span id="dig8Cost">350000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig9"><span><span class="level" id="dig9Level">[0]</span><span id="dig9Text">Holodeck (+10500/Klick, +52500/sec) â€“ <span id="dig9Cost">800000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig10"><span><span class="level" id="dig10Level">[0]</span><span id="dig10Text">Matrix-Interface (+14500/Klick, +72500/sec) â€“ <span id="dig10Cost">1800000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig11"><span><span class="level" id="dig11Level">[0]</span><span id="dig11Text">Gedankenupload (+20000/Klick, +100000/sec) â€“ <span id="dig11Cost">4000000000</span></span></span><button>Kaufen</button></div>
      <div class="upgrader hidden" id="dig12"><span><span class="level" id="dig12Level">[0]</span><span id="dig12Text">Omniszenz (+28000/Klick, +140000/sec) â€“ <span id="dig12Cost">9000000000</span></span></span><button>Kaufen</button></div>
    </div>
  </div>

  <script>
    let count = 0;
    let perClick = 1;
    let autoClicks = 0;
    let teacher = 0;
    let student = 0;
    let role = null;
    let hasExams = false;
    let playerName = '';
    let achievementsShown = [];
    let prestigePoints = 0;
    let totalResets = 0;

    // Difficulty system
    let difficulty = 'medium';
    let difficultyMultiplier = 1;

    // Prestige multipliers
    let clickMultiplier = 1;
    let autoMultiplier = 1;
    let discountLevel = 0;

    // Prestige upgrade costs
    let pClickCost = 1;
    let pAutoCost = 1;
    let pPointsCost = 2;
    let pDiscountCost = 3;

    const counter = document.getElementById('counter');
    const prestigeCounter = document.getElementById('prestigeCounter');
    const btn = document.getElementById('clickBtn');
    const resetBtn = document.getElementById('resetBtn');
    const achievementEl = document.getElementById('achievement');
    let lang = 'de';
    let buyAmount = 1;

    // Difficulty multipliers
    function updateDifficultyMultiplier() {
      if (difficulty === 'baby') {
        difficultyMultiplier = 1 / 10; // Costs 10x cheaper
      } else if (difficulty === 'easy') {
        difficultyMultiplier = 1 / 3; // Costs 3x cheaper
      } else if (difficulty === 'medium') {
        difficultyMultiplier = 1;
      } else if (difficulty === 'hard') {
        difficultyMultiplier = 3; // Costs 3x more expensive
      }
    }
    updateDifficultyMultiplier();

    const translations = {
      de: {
        title: 'Bildungs-Clicker',
        flavour: 'Spielerisches Lernen und Lehren',
        namePlaceholder: 'Dein Name...',
        clickBtn: 'Lerne!',
        clickBtnTeacher: 'Unterrichte!',
        clickBtnStudent: 'Lerne fleiÃŸig!',
        resetBtn: 'Reset',
        prestigePoints: 'Prestige-Punkte',
        prestigeShopTitle: 'Prestige-Shop',
        pClickMulti: 'Klick-Multiplikator x2',
        pAutoMulti: 'Auto-Multiplikator x2',
        pStartBonus: 'Startwert +1000',
        pDiscount: 'Kosten-Reduktion',
        cost: 'Kosten',
        buy: 'Kaufen',
        roleTitle: 'Rolle wÃ¤hlen',
        chooseTeacher: 'Ich bin Lehrer/in',
        chooseStudent: 'Ich bin SchÃ¼ler/in',
        roleText: 'Keine Rolle gewÃ¤hlt.',
        roleTextTeacher: 'Lehrer/in â€“ Wissen weitergeben',
        roleTextStudent: 'SchÃ¼ler/in â€“ Wissenserwerb',
        teacherLabel: 'Kompetenz',
        studentLabel: 'Wissen',
        rank: 'Rang',
        basicsTitle: 'Grundwissen',
        materialsTitle: 'Lehrmittel',
        examsTitle: 'PrÃ¼fungen',
        projectsTitle: 'Projekte',
        digitalTitle: 'Digitale Tools',
        basic1: 'Lesen lernen (+1/Klick)',
        basic2: 'Schreiben Ã¼ben (+2/Klick)',
        basic3: 'Rechnen Ã¼ben (+3/Klick)',
        basic4: 'Vokabeln lernen (+5/Klick)',
        basic5: 'Grammatik verstehen (+7/Klick)',
        basic6: 'Formeln lernen (+10/Klick)',
        basic7: 'ZusammenhÃ¤nge erkennen (+14/Klick)',
        basic8: 'Konzepte verstehen (+20/Klick)',
        basic9: 'Wissen vernetzen (+28/Klick)',
        basic10: 'Meisterschaft (+40/Klick)',
        mat1: 'ArbeitsblÃ¤tter (+1/sec)',
        mat2: 'LehrbÃ¼cher (+2/sec)',
        mat3: 'Ãœbungshefte (+4/sec)',
        mat4: 'Lernkarten (+7/sec)',
        mat5: 'Lexikon (+11/sec)',
        mat6: 'Fachliteratur (+17/sec)',
        mat7: 'Bibliothek (+25/sec)',
        mat8: 'Sammlung (+36/sec)',
        mat9: 'Archiv (+50/sec)',
        mat10: 'Universalbibliothek (+70/sec)',
        mat11: 'Wissenszentrum (+100/sec)',
        mat12: 'Omnibibliothek (+140/sec)',
        exam1: 'Tests (+2/Klick, +10/sec)',
        exam2: 'Klassenarbeiten (+4/Klick, +20/sec)',
        exam3: 'Klausuren (+7/Klick, +35/sec)',
        exam4: 'PrÃ¼fungen (+11/Klick, +55/sec)',
        exam5: 'Staatsexamen (+17/Klick, +85/sec)',
        exam6: 'MeisterprÃ¼fung (+25/Klick, +125/sec)',
        exam7: 'DoktorprÃ¼fung (+36/Klick, +180/sec)',
        exam8: 'ProfessorenprÃ¼fung (+50/Klick, +250/sec)',
        exam9: 'Akademiker-Test (+70/Klick, +350/sec)',
        exam10: 'UniversalprÃ¼fung (+100/Klick, +500/sec)',
        proj1: 'Referat (+30/Klick, +150/sec)',
        proj2: 'PrÃ¤sentation (+50/Klick, +250/sec)',
        proj3: 'Gruppenarbeit (+80/Klick, +400/sec)',
        proj4: 'Facharbeit (+120/Klick, +600/sec)',
        proj5: 'Forschung (+180/Klick, +900/sec)',
        proj6: 'Abschlussarbeit (+260/Klick, +1300/sec)',
        proj7: 'Dissertation (+370/Klick, +1850/sec)',
        proj8: 'Habilitierung (+520/Klick, +2600/sec)',
        proj9: 'Lehrbuch (+720/Klick, +3600/sec)',
        proj10: 'Lebenswerk (+1000/Klick, +5000/sec)',
        dig1: 'Taschenrechner (+400/Klick, +2000/sec)',
        dig2: 'Computer (+700/Klick, +3500/sec)',
        dig3: 'Lern-Apps (+1100/Klick, +5500/sec)',
        dig4: 'Online-Kurse (+1700/Klick, +8500/sec)',
        dig5: 'VR-Lernumgebung (+2500/Klick, +12500/sec)',
        dig6: 'KI-Tutor (+3700/Klick, +18500/sec)',
        dig7: 'Quantencomputer (+5300/Klick, +26500/sec)',
        dig8: 'Nano-Lernchip (+7500/Klick, +37500/sec)',
        dig9: 'Holodeck (+10500/Klick, +52500/sec)',
        dig10: 'Matrix-Interface (+14500/Klick, +72500/sec)',
        dig11: 'Gedankenupload (+20000/Klick, +100000/sec)',
        dig12: 'Omniszenz (+28000/Klick, +140000/sec)',
        saveBtn: 'ðŸ’¾ Speichern',
        loadBtn: 'ðŸ“‚ Laden',
        exportBtn: 'ðŸ“‹ Code Exportieren',
        importBtn: 'ðŸ“¥ Code Importieren',
        gameSaved: 'Spiel gespeichert!',
        gameLoaded: 'Spielstand geladen!',
        noSaveFound: 'Kein Spielstand gefunden!',
        codeExported: 'Code kopiert! In Zwischenablage.',
        codeImported: 'Code importiert!',
        invalidCode: 'UngÃ¼ltiger Code!',
        offlineProgress: 'Willkommen zurÃ¼ck! WÃ¤hrend du weg warst ({time}), hast du {points} Punkte verdient!',
        diffBaby: 'Baby',
        diffEasy: 'Leicht',
        diffMedium: 'Mittel',
        diffHard: 'Schwer',
        perClickLabel: 'Pro Klick',
        perSecLabel: 'Pro Sekunde',
        cheatInput: 'Cheat-Code...',
        cheatBtn: 'ðŸŽ® Code eingeben',
        cheatSuccess: 'Cheat aktiviert!',
        cheatInvalid: 'UngÃ¼ltiger Code!',
        pPointsBonus: '+1 Prestigepunkt',
        buyAmountLabel: 'Kaufen:',
        // Ranks Teacher
        rankNobelPreis: 'NobelpreistrÃ¤ger',
        rankAkademieleiter: 'Akademieleiter',
        rankDekan: 'Dekan',
        rankProfessor: 'Professor',
        rankDozent: 'Dozent',
        rankPrivatdozent: 'Privatdozent',
        rankOberlehrer: 'Oberlehrer',
        rankStudiendirektor: 'Studiendirektor',
        rankFachleiter: 'Fachleiter',
        rankErfahrenerLehrer: 'Erfahrener Lehrer',
        rankJunglehrer: 'Junglehrer',
        rankReferendar: 'Referendar',
        rankPraktikant: 'Praktikant',
        // Ranks Student
        rankUniversalgenie: 'Universalgenie',
        rankPhilosoph: 'Philosoph',
        rankKoryphae: 'KoryphÃ¤e',
        rankGelehrter: 'Gelehrter',
        rankDoktor: 'Doktor',
        rankMagister: 'Magister',
        rankBachelor: 'Bachelor',
        rankStudent: 'Student',
        rankAbiturient: 'Abiturient',
        rankMusterschueler: 'MusterschÃ¼ler',
        rankKlassenbester: 'Klassenbester',
        rankFleissigerSchueler: 'FleiÃŸiger SchÃ¼ler',
        rankErstklaessler: 'ErstklÃ¤ssler',
        rankAnfaenger: 'AnfÃ¤nger'
      },
      en: {
        title: 'Education Clicker',
        flavour: 'Playful Learning and Teaching',
        namePlaceholder: 'Your name...',
        clickBtn: 'Learn!',
        clickBtnTeacher: 'Teach!',
        clickBtnStudent: 'Study hard!',
        resetBtn: 'Reset',
        prestigePoints: 'Prestige Points',
        prestigeShopTitle: 'Prestige Shop',
        pClickMulti: 'Click Multiplier x2',
        pAutoMulti: 'Auto Multiplier x2',
        pStartBonus: 'Start Value +1000',
        pDiscount: 'Cost Reduction',
        cost: 'Cost',
        buy: 'Buy',
        roleTitle: 'Choose Role',
        chooseTeacher: 'I am a Teacher',
        chooseStudent: 'I am a Student',
        roleText: 'No role selected.',
        roleTextTeacher: 'Teacher â€“ Share knowledge',
        roleTextStudent: 'Student â€“ Acquire knowledge',
        teacherLabel: 'Competence',
        studentLabel: 'Knowledge',
        rank: 'Rank',
        basicsTitle: 'Basic Knowledge',
        materialsTitle: 'Learning Materials',
        examsTitle: 'Exams',
        projectsTitle: 'Projects',
        digitalTitle: 'Digital Tools',
        basic1: 'Learn to Read (+1/click)',
        basic2: 'Practice Writing (+2/click)',
        basic3: 'Practice Math (+3/click)',
        basic4: 'Learn Vocabulary (+5/click)',
        basic5: 'Understand Grammar (+7/click)',
        basic6: 'Learn Formulas (+10/click)',
        basic7: 'Recognize Connections (+14/click)',
        basic8: 'Understand Concepts (+20/click)',
        basic9: 'Network Knowledge (+28/click)',
        basic10: 'Mastery (+40/click)',
        mat1: 'Worksheets (+1/sec)',
        mat2: 'Textbooks (+2/sec)',
        mat3: 'Exercise Books (+4/sec)',
        mat4: 'Flashcards (+7/sec)',
        mat5: 'Encyclopedia (+11/sec)',
        mat6: 'Specialized Literature (+17/sec)',
        mat7: 'Library (+25/sec)',
        mat8: 'Collection (+36/sec)',
        mat9: 'Archive (+50/sec)',
        mat10: 'Universal Library (+70/sec)',
        mat11: 'Knowledge Center (+100/sec)',
        mat12: 'Omnilibrary (+140/sec)',
        exam1: 'Tests (+2/click, +10/sec)',
        exam2: 'Class Tests (+4/click, +20/sec)',
        exam3: 'Written Exams (+7/click, +35/sec)',
        exam4: 'Examinations (+11/click, +55/sec)',
        exam5: 'State Exam (+17/click, +85/sec)',
        exam6: 'Master Exam (+25/click, +125/sec)',
        exam7: 'Doctoral Exam (+36/click, +180/sec)',
        exam8: 'Professor Exam (+50/click, +250/sec)',
        exam9: 'Academic Test (+70/click, +350/sec)',
        exam10: 'Universal Exam (+100/click, +500/sec)',
        proj1: 'Report (+30/click, +150/sec)',
        proj2: 'Presentation (+50/click, +250/sec)',
        proj3: 'Group Work (+80/click, +400/sec)',
        proj4: 'Term Paper (+120/click, +600/sec)',
        proj5: 'Research (+180/click, +900/sec)',
        proj6: 'Thesis (+260/click, +1300/sec)',
        proj7: 'Dissertation (+370/click, +1850/sec)',
        proj8: 'Habilitation (+520/click, +2600/sec)',
        proj9: 'Textbook (+720/click, +3600/sec)',
        proj10: 'Life Work (+1000/click, +5000/sec)',
        dig1: 'Calculator (+400/click, +2000/sec)',
        dig2: 'Computer (+700/click, +3500/sec)',
        dig3: 'Learning Apps (+1100/click, +5500/sec)',
        dig4: 'Online Courses (+1700/click, +8500/sec)',
        dig5: 'VR Learning (+2500/click, +12500/sec)',
        dig6: 'AI Tutor (+3700/click, +18500/sec)',
        dig7: 'Quantum Computer (+5300/click, +26500/sec)',
        dig8: 'Nano Learning Chip (+7500/click, +37500/sec)',
        dig9: 'Holodeck (+10500/click, +52500/sec)',
        dig10: 'Matrix Interface (+14500/click, +72500/sec)',
        dig11: 'Mind Upload (+20000/click, +100000/sec)',
        dig12: 'Omniscience (+28000/click, +140000/sec)',
        saveBtn: 'ðŸ’¾ Save',
        loadBtn: 'ðŸ“‚ Load',
        exportBtn: 'ðŸ“‹ Export Code',
        importBtn: 'ðŸ“¥ Import Code',
        gameSaved: 'Game saved!',
        gameLoaded: 'Game loaded!',
        noSaveFound: 'No save found!',
        codeExported: 'Code copied to clipboard!',
        codeImported: 'Code imported!',
        invalidCode: 'Invalid code!',
        offlineProgress: 'Welcome back! While you were away ({time}), you earned {points} points!',
        diffBaby: 'Baby',
        diffEasy: 'Easy',
        diffMedium: 'Medium',
        diffHard: 'Hard',
        perClickLabel: 'Per Click',
        perSecLabel: 'Per Second',
        cheatInput: 'Cheat Code...',
        cheatBtn: 'ðŸŽ® Enter Code',
        cheatSuccess: 'Cheat activated!',
        cheatInvalid: 'Invalid code!',
        pPointsBonus: '+1 Prestige Point',
        buyAmountLabel: 'Buy:',
        rankNobelPreis: 'Nobel Laureate',
        rankAkademieleiter: 'Academy Director',
        rankDekan: 'Dean',
        rankProfessor: 'Professor',
        rankDozent: 'Lecturer',
        rankPrivatdozent: 'Private Lecturer',
        rankOberlehrer: 'Senior Teacher',
        rankStudiendirektor: 'Study Director',
        rankFachleiter: 'Subject Leader',
        rankErfahrenerLehrer: 'Experienced Teacher',
        rankJunglehrer: 'Junior Teacher',
        rankReferendar: 'Trainee Teacher',
        rankPraktikant: 'Intern',
        rankUniversalgenie: 'Universal Genius',
        rankPhilosoph: 'Philosopher',
        rankKoryphae: 'Authority',
        rankGelehrter: 'Scholar',
        rankDoktor: 'Doctor',
        rankMagister: 'Master',
        rankBachelor: 'Bachelor',
        rankStudent: 'Student',
        rankAbiturient: 'Graduate',
        rankMusterschueler: 'Model Student',
        rankKlassenbester: 'Top of Class',
        rankFleissigerSchueler: 'Diligent Student',
        rankErstklaessler: 'First Grader',
        rankAnfaenger: 'Beginner'
      },
    };

    // Owned counters for all upgrades
    const owned = {
      basic1:0, basic2:0, basic3:0, basic4:0, basic5:0, basic6:0, basic7:0, basic8:0, basic9:0, basic10:0,
      mat1:0, mat2:0, mat3:0, mat4:0, mat5:0, mat6:0, mat7:0, mat8:0, mat9:0, mat10:0, mat11:0, mat12:0,
      exam1:0, exam2:0, exam3:0, exam4:0, exam5:0, exam6:0, exam7:0, exam8:0, exam9:0, exam10:0,
      proj1:0, proj2:0, proj3:0, proj4:0, proj5:0, proj6:0, proj7:0, proj8:0, proj9:0, proj10:0,
      dig1:0, dig2:0, dig3:0, dig4:0, dig5:0, dig6:0, dig7:0, dig8:0, dig9:0, dig10:0, dig11:0, dig12:0
    };

    const basicUpgrades = [
      {id:'basic1', baseCost:50, increment:1, costEl:'basic1Cost', cost:50, mult:1.15, prev:null},
      {id:'basic2', baseCost:200, increment:2, costEl:'basic2Cost', cost:200, mult:1.15, prev:'basic1'},
      {id:'basic3', baseCost:500, increment:3, costEl:'basic3Cost', cost:500, mult:1.15, prev:'basic2'},
      {id:'basic4', baseCost:1000, increment:5, costEl:'basic4Cost', cost:1000, mult:1.15, prev:'basic3'},
      {id:'basic5', baseCost:2000, increment:7, costEl:'basic5Cost', cost:2000, mult:1.15, prev:'basic4'},
      {id:'basic6', baseCost:4000, increment:10, costEl:'basic6Cost', cost:4000, mult:1.15, prev:'basic5'},
      {id:'basic7', baseCost:8000, increment:14, costEl:'basic7Cost', cost:8000, mult:1.15, prev:'basic6'},
      {id:'basic8', baseCost:15000, increment:20, costEl:'basic8Cost', cost:15000, mult:1.15, prev:'basic7'},
      {id:'basic9', baseCost:30000, increment:28, costEl:'basic9Cost', cost:30000, mult:1.15, prev:'basic8'},
      {id:'basic10', baseCost:60000, increment:40, costEl:'basic10Cost', cost:60000, mult:1.15, prev:'basic9'}
    ];

    const materialUpgrades = [
      {id:'mat1', baseCost:500, increment:1, costEl:'mat1Cost', cost:500, mult:1.2, prev:null},
      {id:'mat2', baseCost:1000, increment:2, costEl:'mat2Cost', cost:1000, mult:1.2, prev:'mat1'},
      {id:'mat3', baseCost:2500, increment:4, costEl:'mat3Cost', cost:2500, mult:1.2, prev:'mat2'},
      {id:'mat4', baseCost:5000, increment:7, costEl:'mat4Cost', cost:5000, mult:1.2, prev:'mat3'},
      {id:'mat5', baseCost:10000, increment:11, costEl:'mat5Cost', cost:10000, mult:1.2, prev:'mat4'},
      {id:'mat6', baseCost:20000, increment:17, costEl:'mat6Cost', cost:20000, mult:1.2, prev:'mat5'},
      {id:'mat7', baseCost:40000, increment:25, costEl:'mat7Cost', cost:40000, mult:1.2, prev:'mat6'},
      {id:'mat8', baseCost:80000, increment:36, costEl:'mat8Cost', cost:80000, mult:1.2, prev:'mat7'},
      {id:'mat9', baseCost:150000, increment:50, costEl:'mat9Cost', cost:150000, mult:1.2, prev:'mat8'},
      {id:'mat10', baseCost:300000, increment:70, costEl:'mat10Cost', cost:300000, mult:1.2, prev:'mat9'},
      {id:'mat11', baseCost:600000, increment:100, costEl:'mat11Cost', cost:600000, mult:1.2, prev:'mat10'},
      {id:'mat12', baseCost:1200000, increment:140, costEl:'mat12Cost', cost:1200000, mult:1.2, prev:'mat11'}
    ];

    const examUpgrades = [
      {id:'exam1', baseCost:15000, incrementClick:2, incrementAuto:10, costEl:'exam1Cost', cost:15000, mult:1.25, prev:null},
      {id:'exam2', baseCost:30000, incrementClick:4, incrementAuto:20, costEl:'exam2Cost', cost:30000, mult:1.25, prev:'exam1'},
      {id:'exam3', baseCost:60000, incrementClick:7, incrementAuto:35, costEl:'exam3Cost', cost:60000, mult:1.25, prev:'exam2'},
      {id:'exam4', baseCost:120000, incrementClick:11, incrementAuto:55, costEl:'exam4Cost', cost:120000, mult:1.25, prev:'exam3'},
      {id:'exam5', baseCost:250000, incrementClick:17, incrementAuto:85, costEl:'exam5Cost', cost:250000, mult:1.25, prev:'exam4'},
      {id:'exam6', baseCost:500000, incrementClick:25, incrementAuto:125, costEl:'exam6Cost', cost:500000, mult:1.25, prev:'exam5'},
      {id:'exam7', baseCost:1000000, incrementClick:36, incrementAuto:180, costEl:'exam7Cost', cost:1000000, mult:1.25, prev:'exam6'},
      {id:'exam8', baseCost:2000000, incrementClick:50, incrementAuto:250, costEl:'exam8Cost', cost:2000000, mult:1.25, prev:'exam7'},
      {id:'exam9', baseCost:4000000, incrementClick:70, incrementAuto:350, costEl:'exam9Cost', cost:4000000, mult:1.25, prev:'exam8'},
      {id:'exam10', baseCost:8000000, incrementClick:100, incrementAuto:500, costEl:'exam10Cost', cost:8000000, mult:1.25, prev:'exam9'}
    ];

    const projectUpgrades = [
      {id:'proj1', baseCost:100000, incrementClick:30, incrementAuto:150, costEl:'proj1Cost', cost:100000, mult:1.3, prev:null},
      {id:'proj2', baseCost:250000, incrementClick:50, incrementAuto:250, costEl:'proj2Cost', cost:250000, mult:1.3, prev:'proj1'},
      {id:'proj3', baseCost:600000, incrementClick:80, incrementAuto:400, costEl:'proj3Cost', cost:600000, mult:1.3, prev:'proj2'},
      {id:'proj4', baseCost:1500000, incrementClick:120, incrementAuto:600, costEl:'proj4Cost', cost:1500000, mult:1.3, prev:'proj3'},
      {id:'proj5', baseCost:3500000, incrementClick:180, incrementAuto:900, costEl:'proj5Cost', cost:3500000, mult:1.3, prev:'proj4'},
      {id:'proj6', baseCost:7000000, incrementClick:260, incrementAuto:1300, costEl:'proj6Cost', cost:7000000, mult:1.3, prev:'proj5'},
      {id:'proj7', baseCost:15000000, incrementClick:370, incrementAuto:1850, costEl:'proj7Cost', cost:15000000, mult:1.3, prev:'proj6'},
      {id:'proj8', baseCost:30000000, incrementClick:520, incrementAuto:2600, costEl:'proj8Cost', cost:30000000, mult:1.3, prev:'proj7'},
      {id:'proj9', baseCost:60000000, incrementClick:720, incrementAuto:3600, costEl:'proj9Cost', cost:60000000, mult:1.3, prev:'proj8'},
      {id:'proj10', baseCost:120000000, incrementClick:1000, incrementAuto:5000, costEl:'proj10Cost', cost:120000000, mult:1.3, prev:'proj9'}
    ];

    const digitalUpgrades = [
      {id:'dig1', baseCost:500000, incrementClick:400, incrementAuto:2000, costEl:'dig1Cost', cost:500000, mult:1.35, prev:null},
      {id:'dig2', baseCost:1500000, incrementClick:700, incrementAuto:3500, costEl:'dig2Cost', cost:1500000, mult:1.35, prev:'dig1'},
      {id:'dig3', baseCost:4000000, incrementClick:1100, incrementAuto:5500, costEl:'dig3Cost', cost:4000000, mult:1.35, prev:'dig2'},
      {id:'dig4', baseCost:10000000, incrementClick:1700, incrementAuto:8500, costEl:'dig4Cost', cost:10000000, mult:1.35, prev:'dig3'},
      {id:'dig5', baseCost:25000000, incrementClick:2500, incrementAuto:12500, costEl:'dig5Cost', cost:25000000, mult:1.35, prev:'dig4'},
      {id:'dig6', baseCost:60000000, incrementClick:3700, incrementAuto:18500, costEl:'dig6Cost', cost:60000000, mult:1.35, prev:'dig5'},
      {id:'dig7', baseCost:150000000, incrementClick:5300, incrementAuto:26500, costEl:'dig7Cost', cost:150000000, mult:1.35, prev:'dig6'},
      {id:'dig8', baseCost:350000000, incrementClick:7500, incrementAuto:37500, costEl:'dig8Cost', cost:350000000, mult:1.35, prev:'dig7'},
      {id:'dig9', baseCost:800000000, incrementClick:10500, incrementAuto:52500, costEl:'dig9Cost', cost:800000000, mult:1.35, prev:'dig8'},
      {id:'dig10', baseCost:1800000000, incrementClick:14500, incrementAuto:72500, costEl:'dig10Cost', cost:1800000000, mult:1.35, prev:'dig9'},
      {id:'dig11', baseCost:4000000000, incrementClick:20000, incrementAuto:100000, costEl:'dig11Cost', cost:4000000000, mult:1.35, prev:'dig10'},
      {id:'dig12', baseCost:9000000000, incrementClick:28000, incrementAuto:140000, costEl:'dig12Cost', cost:9000000000, mult:1.35, prev:'dig11'}
    ];

    const unlockThresholds = {
      blockMaterials: 500,
      blockExams: 15000,
      blockProjects: 100000,
      blockDigital: 500000
    };

    document.getElementById('nameInput').addEventListener('input', (e) => {
      playerName = e.target.value;
    });

    function updateLanguage() {
      const t = translations[lang];
      document.getElementById('title').textContent = t.title;
      document.getElementById('flavour').textContent = t.flavour;
      document.getElementById('nameInput').placeholder = t.namePlaceholder;
      document.getElementById('roleTitle').textContent = t.roleTitle;
      document.getElementById('chooseTeacher').textContent = t.chooseTeacher;
      document.getElementById('chooseStudent').textContent = t.chooseStudent;
      document.getElementById('teacherLabel').textContent = t.teacherLabel;
      document.getElementById('studentLabel').textContent = t.studentLabel;
      document.getElementById('basicsTitle').textContent = t.basicsTitle;
      document.getElementById('materialsTitle').textContent = t.materialsTitle;
      document.getElementById('examsTitle').textContent = t.examsTitle;
      document.getElementById('projectsTitle').textContent = t.projectsTitle;
      document.getElementById('digitalTitle').textContent = t.digitalTitle;

      // Update prestige shop
      const prestigeShop = document.querySelector('#prestigeShop h2');
      if (prestigeShop) prestigeShop.textContent = t.prestigeShopTitle;

      if (role === 'teacher') {
        btn.textContent = t.clickBtnTeacher;
        document.getElementById('roleText').textContent = t.roleTextTeacher;
      } else if (role === 'student') {
        btn.textContent = t.clickBtnStudent;
        document.getElementById('roleText').textContent = t.roleTextStudent;
      } else {
        btn.textContent = t.clickBtn;
        document.getElementById('roleText').textContent = t.roleText;
      }

      // Update all buy buttons
      document.querySelectorAll('.upgrader button, .prestigeUpgrade button').forEach(btn => {
        btn.textContent = t.buy;
      });

      // Update prestige shop texts
      const pClickSpan = document.querySelector('#prestigeShop .prestigeUpgrade:nth-child(2) span');
      const pAutoSpan = document.querySelector('#prestigeShop .prestigeUpgrade:nth-child(3) span');
      const pPointsSpan = document.querySelector('#prestigeShop .prestigeUpgrade:nth-child(4) span');
      const pDiscountSpan = document.querySelector('#prestigeShop .prestigeUpgrade:nth-child(5) span');

      if (pClickSpan) pClickSpan.innerHTML = `${t.pClickMulti} (${t.cost}: <span id="pClickCost">${pClickCost}</span>)`;
      if (pAutoSpan) pAutoSpan.innerHTML = `${t.pAutoMulti} (${t.cost}: <span id="pAutoCost">${pAutoCost}</span>)`;
      if (pPointsSpan) pPointsSpan.innerHTML = `${t.pPointsBonus} (${t.cost}: <span id="pPointsCost">${pPointsCost}</span>)`;
      if (pDiscountSpan) pDiscountSpan.innerHTML = `${t.pDiscount} (${t.cost}: <span id="pDiscountCost">${pDiscountCost}</span>)`;

      // Update per click/second labels
      document.getElementById('perClickLabel').textContent = t.perClickLabel;
      document.getElementById('perSecLabel').textContent = t.perSecLabel;
      document.getElementById('cheatInput').placeholder = t.cheatInput;
      document.getElementById('cheatBtn').textContent = t.cheatBtn;
      document.getElementById('buyAmountLabel').textContent = t.buyAmountLabel;

      // Update all upgrade texts
      const updateUpgradeText = (id, upgradeData) => {
        const textEl = document.getElementById(id + 'Text');
        const costEl = document.getElementById(id + 'Cost');
        if (textEl && costEl) {
          textEl.innerHTML = `${t[id]} â€“ <span id="${id}Cost">${costEl.textContent}</span>`;
        }
      };

      // Update basic upgrades
      for (let i = 1; i <= 10; i++) {
        updateUpgradeText('basic' + i, basicUpgrades[i-1]);
      }

      // Update material upgrades
      for (let i = 1; i <= 12; i++) {
        updateUpgradeText('mat' + i, materialUpgrades[i-1]);
      }

      // Update exam upgrades
      for (let i = 1; i <= 10; i++) {
        updateUpgradeText('exam' + i, examUpgrades[i-1]);
      }

      // Update project upgrades
      for (let i = 1; i <= 10; i++) {
        updateUpgradeText('proj' + i, projectUpgrades[i-1]);
      }

      // Update digital upgrades
      for (let i = 1; i <= 12; i++) {
        updateUpgradeText('dig' + i, digitalUpgrades[i-1]);
      }

      // Update save/load/export/import buttons
      document.getElementById('saveBtn').textContent = t.saveBtn;
      document.getElementById('loadBtn').textContent = t.loadBtn;
      document.getElementById('exportBtn').textContent = t.exportBtn;
      document.getElementById('importBtn').textContent = t.importBtn;

      // Update difficulty select options
      const diffSelect = document.getElementById('difficultySelect');
      if (diffSelect) {
        diffSelect.options[0].textContent = t.diffBaby || 'Baby';
        diffSelect.options[1].textContent = t.diffEasy || 'Leicht / Easy';
        diffSelect.options[2].textContent = t.diffMedium || 'Mittel / Medium';
        diffSelect.options[3].textContent = t.diffHard || 'Schwer / Hard';
      }

      updateRank();
    }

    document.getElementById('langSelect').onchange = (e) => {
      lang = e.target.value;
      updateLanguage();
    };

    function update() {
      counter.textContent = formatNumber(Math.floor(count));
      const t = translations[lang];
      prestigeCounter.textContent = t.prestigePoints + ': ' + prestigePoints;

      // Update per click and per second displays
      const totalPerClick = Math.floor(perClick * clickMultiplier);
      const totalPerSec = Math.floor(autoClicks * autoMultiplier);
      document.getElementById('perClickDisplay').textContent = formatNumber(totalPerClick);
      document.getElementById('perSecDisplay').textContent = formatNumber(totalPerSec);

      updateButtonStates();
      checkUnlocks();
      updateResetButton();
    }

    function formatNumber(num) {
      if (num >= 1e12) return (num/1e12).toFixed(2) + 'T';
      if (num >= 1e9) return (num/1e9).toFixed(2) + 'B';
      if (num >= 1e6) return (num/1e6).toFixed(2) + 'M';
      if (num >= 1e3) return (num/1e3).toFixed(2) + 'K';
      return num.toString();
    }

    function checkUnlocks() {
      // Unlock blocks
      for (const [id, threshold] of Object.entries(unlockThresholds)) {
        if (count >= threshold) {
          const el = document.getElementById(id);
          if (el && el.classList.contains('hidden')) {
            el.classList.remove('hidden');
          }
        }
      }

      // Unlock individual upgrades based on previous upgrade having 10 owned
      checkUpgradeUnlock(basicUpgrades);
      checkUpgradeUnlock(materialUpgrades);
      checkUpgradeUnlock(examUpgrades);
      checkUpgradeUnlock(projectUpgrades);
      checkUpgradeUnlock(digitalUpgrades);
    }

    function checkUpgradeUnlock(upgrades) {
      upgrades.forEach(u => {
        if (u.prev === null) return; // First upgrade always visible

        const prevUpgrade = upgrades.find(up => up.id === u.prev);
        if (prevUpgrade && owned[prevUpgrade.id] >= 10) {
          const el = document.getElementById(u.id);
          if (el && el.classList.contains('hidden')) {
            el.classList.remove('hidden');
          }
        }
      });
    }

    function updateButtonStates() {
      updateUpgradeButtons(basicUpgrades);
      updateUpgradeButtons(materialUpgrades);
      updateUpgradeButtons(examUpgrades);
      updateUpgradeButtons(projectUpgrades);
      updateUpgradeButtons(digitalUpgrades);
    }

    function updateUpgradeButtons(upgrades) {
      upgrades.forEach(u => {
        const upgraderEl = document.getElementById(u.id);
        if (!upgraderEl) return;
        const btn = upgraderEl.querySelector('button');
        const discountFactor = Math.pow(0.95, discountLevel);
        const baseCost = Math.floor(u.cost * discountFactor);
        const totalCost = calculateTotalCost(baseCost, buyAmount, u.mult);

        btn.disabled = count < totalCost;

        // Update button text to show cost for buyAmount
        if (buyAmount > 1) {
          btn.innerHTML = `${translations[lang].buy} x${buyAmount}<br><small>${formatNumber(totalCost)}</small>`;
        } else {
          btn.textContent = translations[lang].buy;
        }
      });
    }

    function updateResetButton() {
      const resetThreshold = 10000000;
      resetBtn.disabled = count < resetThreshold;
      // Dynamic prestige calculation: sqrt of points in millions
      const prestigeGain = Math.floor(Math.sqrt(count / 1000000));
      const t = translations[lang];
      resetBtn.textContent = `${t.resetBtn} (${formatNumber(resetThreshold)}) â†’ +${prestigeGain} PP`;
    }

    function checkAchievements() {
      const milestones = [100, 500, 1000, 5000, 10000, 50000, 100000, 500000, 1000000, 5000000];
      milestones.forEach(m => {
        if (count >= m && !achievementsShown.includes(m)) {
          showAchievement(m);
          achievementsShown.push(m);
        }
      });
    }

    function showAchievement(milestone) {
      const name = playerName || 'Spieler';
      const messages = {
        100: `${name}, du machst tolle Fortschritte!`,
        500: `${name}, du entwickelst echte Lernfreude!`,
        1000: `Beeindruckend, ${name}!`,
        5000: `${name}, du bist ein Lerntalent!`,
        10000: `Hervorragend, ${name}!`,
        50000: `${name}, du bist ein Vorbild!`,
        100000: `Fantastisch, ${name}!`,
        500000: `${name}, du bist auÃŸergewÃ¶hnlich!`,
        1000000: `${name}, eine Million! Unglaublich!`,
        5000000: `${name}, 5 Millionen! Du bist eine Legende!`
      };

      achievementEl.textContent = messages[milestone];
      achievementEl.style.display = 'block';

      setTimeout(() => {
        achievementEl.style.display = 'none';
      }, 5000);
    }

    document.getElementById('chooseTeacher').onclick = () => {
      role = 'teacher';
      btn.textContent = 'Unterrichte!';
      document.getElementById('roleText').textContent = 'Lehrer/in â€“ Wissen weitergeben';
    };

    document.getElementById('chooseStudent').onclick = () => {
      role = 'student';
      btn.textContent = 'Lerne fleiÃŸig!';
      document.getElementById('roleText').textContent = 'SchÃ¼ler/in â€“ Wissenserwerb';
    };

    btn.onclick = () => {
      count += perClick * clickMultiplier;

      if(role === 'teacher') {
        if (hasExams) {
          teacher += (perClick * clickMultiplier) / 5;
        } else if (teacher < 1000) {
          teacher += (perClick * clickMultiplier) / 10;
        } else {
          teacher += (perClick * clickMultiplier) / 20;
        }
      }
      if(role === 'student') {
        if (hasExams) {
          student += (perClick * clickMultiplier) / 5;
        } else if (student < 1000) {
          student += (perClick * clickMultiplier) / 10;
        } else {
          student += (perClick * clickMultiplier) / 20;
        }
      }

      document.getElementById('teacherMeter').textContent = Math.floor(teacher);
      document.getElementById('studentMeter').textContent = Math.floor(student);
      updateRank();
      update();
      checkAchievements();
    };

    resetBtn.onclick = () => {
      if (count >= 10000000) {
        const prestigeGain = Math.floor(Math.sqrt(count / 1000000));
        if (confirm(`Reset bestÃ¤tigen?\n\nDu erhÃ¤ltst ${prestigeGain} Prestige-Punkte und beginnst von vorne, behÃ¤ltst aber alle Prestige-Upgrades!`)) {
          prestigePoints += prestigeGain;
          totalResets++;

          // Reset game state
          count = 0;
          perClick = 1;
          autoClicks = 0;
          teacher = 0;
          student = 0;
          achievementsShown = [];

          // Reset all owned counters
          for (let key in owned) {
            owned[key] = 0;
          }

          // Reset all upgrade costs
          basicUpgrades.forEach(u => {
            u.cost = u.baseCost;
            document.getElementById(u.costEl).textContent = u.baseCost;
            document.getElementById(u.id + 'Level').textContent = '[0]';
            if (u.prev !== null) {
              document.getElementById(u.id).classList.add('hidden');
            }
          });

          materialUpgrades.forEach(u => {
            u.cost = u.baseCost;
            document.getElementById(u.costEl).textContent = u.baseCost;
            document.getElementById(u.id + 'Level').textContent = '[0]';
            if (u.prev !== null) {
              document.getElementById(u.id).classList.add('hidden');
            }
          });

          examUpgrades.forEach(u => {
            u.cost = u.baseCost;
            document.getElementById(u.costEl).textContent = u.baseCost;
            document.getElementById(u.id + 'Level').textContent = '[0]';
            if (u.prev !== null) {
              document.getElementById(u.id).classList.add('hidden');
            }
          });

          projectUpgrades.forEach(u => {
            u.cost = u.baseCost;
            document.getElementById(u.costEl).textContent = u.baseCost;
            document.getElementById(u.id + 'Level').textContent = '[0]';
            if (u.prev !== null) {
              document.getElementById(u.id).classList.add('hidden');
            }
          });

          digitalUpgrades.forEach(u => {
            u.cost = u.baseCost;
            document.getElementById(u.costEl).textContent = u.baseCost;
            document.getElementById(u.id + 'Level').textContent = '[0]';
            if (u.prev !== null) {
              document.getElementById(u.id).classList.add('hidden');
            }
          });

          // Hide blocks again
          document.getElementById('blockMaterials').classList.add('hidden');
          document.getElementById('blockExams').classList.add('hidden');
          document.getElementById('blockProjects').classList.add('hidden');
          document.getElementById('blockDigital').classList.add('hidden');

          // Show prestige shop after first reset
          if (totalResets >= 1) {
            document.getElementById('prestigeShop').classList.remove('hidden');
          }

          update();
          updateRank();
        }
      }
    };

    // Prestige shop buttons
    document.getElementById('pClickBtn').onclick = () => {
      if (prestigePoints >= pClickCost) {
        prestigePoints -= pClickCost;
        clickMultiplier *= 2;
        pClickCost = Math.ceil(pClickCost * 2.5);
        document.getElementById('pClickCost').textContent = pClickCost;
        update();
      }
    };

    document.getElementById('pAutoBtn').onclick = () => {
      if (prestigePoints >= pAutoCost) {
        prestigePoints -= pAutoCost;
        autoMultiplier *= 2;
        pAutoCost = Math.ceil(pAutoCost * 2.5);
        document.getElementById('pAutoCost').textContent = pAutoCost;
        update();
      }
    };

    document.getElementById('pPointsBtn').onclick = () => {
      if (prestigePoints >= pPointsCost) {
        prestigePoints -= pPointsCost;
        prestigePoints += 1;  // Give back 1 prestige point as reward
        pPointsCost = Math.ceil(pPointsCost * 2.5);
        document.getElementById('pPointsCost').textContent = pPointsCost;
        update();
      }
    };

    document.getElementById('pDiscountBtn').onclick = () => {
      if (prestigePoints >= pDiscountCost) {
        prestigePoints -= pDiscountCost;
        discountLevel++;
        pDiscountCost = Math.ceil(pDiscountCost * 2.5);
        document.getElementById('pDiscountCost').textContent = pDiscountCost;
        update();
      }
    };

    function setupUpgrade(upgrade, isClick, isAuto) {
      const upgraderEl = document.getElementById(upgrade.id);
      const btn = upgraderEl.querySelector('button');
      btn.onclick = () => {
        const discountFactor = Math.pow(0.95, discountLevel);
        const baseCost = Math.floor(upgrade.cost * discountFactor);

        // Calculate total cost for buyAmount purchases
        const totalCost = calculateTotalCost(baseCost, buyAmount, upgrade.mult);

        if (count >= totalCost) {
          count -= totalCost;

          // Apply buyAmount times
          for (let i = 0; i < buyAmount; i++) {
            owned[upgrade.id]++;

            if (isClick) {
              perClick += upgrade.incrementClick || upgrade.increment;
            }
            if (isAuto) {
              autoClicks += upgrade.incrementAuto || upgrade.increment;
            }
            if (upgrade.incrementClick && upgrade.incrementAuto) {
              hasExams = true;
            }

            upgrade.cost = Math.floor(upgrade.cost * upgrade.mult);
          }

          document.getElementById(upgrade.costEl).textContent = formatNumber(upgrade.cost);
          document.getElementById(upgrade.id + 'Level').textContent = `[${owned[upgrade.id]}]`;
          update();
        }
      };
    }

    basicUpgrades.forEach(u => setupUpgrade(u, true, false));
    materialUpgrades.forEach(u => setupUpgrade(u, false, true));
    examUpgrades.forEach(u => setupUpgrade(u, true, true));
    projectUpgrades.forEach(u => setupUpgrade(u, true, true));
    digitalUpgrades.forEach(u => setupUpgrade(u, true, true));

    setInterval(() => {
      count += autoClicks * autoMultiplier;

      if(role === 'teacher') {
        if (hasExams) {
          teacher += (autoClicks * autoMultiplier) / 50;
        } else if (teacher < 1000) {
          teacher += (autoClicks * autoMultiplier) / 100;
        }
      }
      if(role === 'student') {
        if (hasExams) {
          student += (autoClicks * autoMultiplier) / 50;
        } else if (student < 1000) {
          student += (autoClicks * autoMultiplier) / 100;
        }
      }

      document.getElementById('teacherMeter').textContent = Math.floor(teacher);
      document.getElementById('studentMeter').textContent = Math.floor(student);
      updateRank();
      update();
      checkAchievements();
    }, 1000);

    function updateRank() {
      const t = translations[lang];
      let r = t.rankAnfaenger;
      let v = role === 'teacher' ? teacher : student;
      const prefix = role === 'teacher' ? 'Lehrer' : (role === 'student' ? 'SchÃ¼ler' : '');

      if (prefix === 'Lehrer') {
        if (v > 500000) r = t.rankNobelPreis;
        else if (v > 200000) r = t.rankAkademieleiter;
        else if (v > 100000) r = t.rankDekan;
        else if (v > 50000) r = t.rankProfessor;
        else if (v > 25000) r = t.rankDozent;
        else if (v > 12000) r = t.rankPrivatdozent;
        else if (v > 6000) r = t.rankOberlehrer;
        else if (v > 3000) r = t.rankStudiendirektor;
        else if (v > 1500) r = t.rankFachleiter;
        else if (v > 700) r = t.rankErfahrenerLehrer;
        else if (v > 300) r = t.rankJunglehrer;
        else if (v > 100) r = t.rankReferendar;
        else if (v > 30) r = t.rankPraktikant;
      } else if (prefix === 'SchÃ¼ler') {
        if (v > 500000) r = t.rankUniversalgenie;
        else if (v > 200000) r = t.rankPhilosoph;
        else if (v > 100000) r = t.rankKoryphae;
        else if (v > 50000) r = t.rankGelehrter;
        else if (v > 25000) r = t.rankDoktor;
        else if (v > 12000) r = t.rankMagister;
        else if (v > 6000) r = t.rankBachelor;
        else if (v > 3000) r = t.rankStudent;
        else if (v > 1500) r = t.rankAbiturient;
        else if (v > 700) r = t.rankMusterschueler;
        else if (v > 300) r = t.rankKlassenbester;
        else if (v > 100) r = t.rankFleissigerSchueler;
        else if (v > 30) r = t.rankErstklaessler;
      }

      document.getElementById('rank').textContent = t.rank + ': ' + r;
    }

    // Update prestige shop buttons
    setInterval(() => {
      document.getElementById('pClickBtn').disabled = prestigePoints < pClickCost;
      document.getElementById('pAutoBtn').disabled = prestigePoints < pAutoCost;
      document.getElementById('pPointsBtn').disabled = prestigePoints < pPointsCost;
      document.getElementById('pDiscountBtn').disabled = prestigePoints < pDiscountCost;
    }, 100);

    // Difficulty selection
    document.getElementById('difficultySelect').onchange = (e) => {
      const newDifficulty = e.target.value;
      if (confirm('Schwierigkeit Ã¤ndern? Dies wird alle Kosten anpassen!\nChange difficulty? This will adjust all costs!')) {
        difficulty = newDifficulty;
        updateDifficultyMultiplier();

        // Reset all upgrade costs with new difficulty
        basicUpgrades.forEach(u => {
          u.cost = Math.floor(u.baseCost * difficultyMultiplier);
          document.getElementById(u.costEl).textContent = formatNumber(u.cost);
        });
        materialUpgrades.forEach(u => {
          u.cost = Math.floor(u.baseCost * difficultyMultiplier);
          document.getElementById(u.costEl).textContent = formatNumber(u.cost);
        });
        examUpgrades.forEach(u => {
          u.cost = Math.floor(u.baseCost * difficultyMultiplier);
          document.getElementById(u.costEl).textContent = formatNumber(u.cost);
        });
        projectUpgrades.forEach(u => {
          u.cost = Math.floor(u.baseCost * difficultyMultiplier);
          document.getElementById(u.costEl).textContent = formatNumber(u.cost);
        });
        digitalUpgrades.forEach(u => {
          u.cost = Math.floor(u.baseCost * difficultyMultiplier);
          document.getElementById(u.costEl).textContent = formatNumber(u.cost);
        });

        update();
      } else {
        e.target.value = difficulty;
      }
    };

    // Save/Load System
    function saveGame(manual = false) {
      const gameState = {
        count, perClick, autoClicks, teacher, student, role, hasExams,
        playerName, achievementsShown, prestigePoints, totalResets,
        difficulty, difficultyMultiplier,
        clickMultiplier, autoMultiplier, discountLevel,
        pClickCost, pAutoCost, pPointsCost, pDiscountCost,
        lang, owned,
        lastSaveTime: Date.now(),
        basicUpgrades: basicUpgrades.map(u => ({cost: u.cost})),
        materialUpgrades: materialUpgrades.map(u => ({cost: u.cost})),
        examUpgrades: examUpgrades.map(u => ({cost: u.cost})),
        projectUpgrades: projectUpgrades.map(u => ({cost: u.cost})),
        digitalUpgrades: digitalUpgrades.map(u => ({cost: u.cost}))
      };
      localStorage.setItem('schulClickerSave', JSON.stringify(gameState));
      if (manual) {
        const t = translations[lang];
        alert(t.gameSaved || 'Spiel gespeichert! / Game saved!');
      }
    }

    function loadGame() {
      const saved = localStorage.getItem('schulClickerSave');
      if (!saved) {
        alert('Kein Spielstand gefunden! / No save found!');
        return;
      }

      if (confirm('Gespeicherten Stand laden? / Load saved game?')) {
        try {
          const gameState = JSON.parse(saved);

          count = gameState.count || 0;
          perClick = gameState.perClick || 1;
          autoClicks = gameState.autoClicks || 0;
          teacher = gameState.teacher || 0;
          student = gameState.student || 0;
          role = gameState.role || null;
          hasExams = gameState.hasExams || false;
          playerName = gameState.playerName || '';
          achievementsShown = gameState.achievementsShown || [];
          prestigePoints = gameState.prestigePoints || 0;
          totalResets = gameState.totalResets || 0;
          difficulty = gameState.difficulty || 'medium';
          difficultyMultiplier = gameState.difficultyMultiplier || 1;
          clickMultiplier = gameState.clickMultiplier || 1;
          autoMultiplier = gameState.autoMultiplier || 1;
          discountLevel = gameState.discountLevel || 0;
          pClickCost = gameState.pClickCost || 1;
          pAutoCost = gameState.pAutoCost || 1;
          pPointsCost = gameState.pPointsCost || 2;
          pDiscountCost = gameState.pDiscountCost || 3;
          lang = gameState.lang || 'de';

          // Calculate offline progress
          if (gameState.lastSaveTime && autoClicks > 0) {
            const timeAway = Date.now() - gameState.lastSaveTime;
            const secondsAway = Math.floor(timeAway / 1000);
            const minutesAway = Math.floor(secondsAway / 60);

            if (secondsAway > 60) {
              const offlineEarnings = Math.floor(secondsAway * autoClicks * autoMultiplier);
              count += offlineEarnings;

              // Format time string
              const hours = Math.floor(secondsAway / 3600);
              const minutes = Math.floor((secondsAway % 3600) / 60);
              let timeStr = '';
              if (hours > 0) timeStr += hours + ' h ';
              if (minutes > 0) timeStr += minutes + ' min';
              if (timeStr === '') timeStr = '< 1 min';

              // Will show message after loading completes
              setTimeout(() => {
                const t = translations[lang];
                const message = t.offlineProgress
                  .replace('{time}', timeStr)
                  .replace('{points}', formatNumber(offlineEarnings));
                alert(message);
              }, 100);
            }
          }

          if (gameState.owned) {
            for (let key in gameState.owned) {
              owned[key] = gameState.owned[key];
            }
          }

          // Restore upgrade costs
          if (gameState.basicUpgrades) {
            gameState.basicUpgrades.forEach((saved, i) => {
              if (basicUpgrades[i]) {
                basicUpgrades[i].cost = saved.cost;
              }
            });
          }
          if (gameState.materialUpgrades) {
            gameState.materialUpgrades.forEach((saved, i) => {
              if (materialUpgrades[i]) {
                materialUpgrades[i].cost = saved.cost;
              }
            });
          }
          if (gameState.examUpgrades) {
            gameState.examUpgrades.forEach((saved, i) => {
              if (examUpgrades[i]) {
                examUpgrades[i].cost = saved.cost;
              }
            });
          }
          if (gameState.projectUpgrades) {
            gameState.projectUpgrades.forEach((saved, i) => {
              if (projectUpgrades[i]) {
                projectUpgrades[i].cost = saved.cost;
              }
            });
          }
          if (gameState.digitalUpgrades) {
            gameState.digitalUpgrades.forEach((saved, i) => {
              if (digitalUpgrades[i]) {
                digitalUpgrades[i].cost = saved.cost;
              }
            });
          }

          // Update UI
          document.getElementById('nameInput').value = playerName;
          document.getElementById('langSelect').value = lang;
          document.getElementById('difficultySelect').value = difficulty;

          // Update level displays
          for (let key in owned) {
            const levelEl = document.getElementById(key + 'Level');
            if (levelEl) {
              levelEl.textContent = `[${owned[key]}]`;
            }
          }

          // Show prestige shop if needed
          if (totalResets >= 1) {
            document.getElementById('prestigeShop').classList.remove('hidden');
          }

          updateLanguage();
          update();
          updateRank();
          alert('Spielstand geladen! / Game loaded!');
        } catch (e) {
          alert('Fehler beim Laden! / Loading error: ' + e.message);
        }
      }
    }

    // Export/Import System
    function exportGame() {
      const gameState = {
        count, perClick, autoClicks, teacher, student, role, hasExams,
        playerName, achievementsShown, prestigePoints, totalResets,
        difficulty, difficultyMultiplier,
        clickMultiplier, autoMultiplier, discountLevel,
        pClickCost, pAutoCost, pPointsCost, pDiscountCost,
        lang, owned,
        basicUpgrades: basicUpgrades.map(u => ({cost: u.cost})),
        materialUpgrades: materialUpgrades.map(u => ({cost: u.cost})),
        examUpgrades: examUpgrades.map(u => ({cost: u.cost})),
        projectUpgrades: projectUpgrades.map(u => ({cost: u.cost})),
        digitalUpgrades: digitalUpgrades.map(u => ({cost: u.cost}))
      };

      const code = btoa(JSON.stringify(gameState));

      const textarea = document.createElement('textarea');
      textarea.value = code;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);

      alert('Code kopiert! In Zwischenablage.\nCode copied to clipboard:\n\n' + code.substring(0, 50) + '...');
    }

    function importGame() {
      const code = prompt('Code einfÃ¼gen / Paste code:');
      if (!code) return;

      try {
        const gameState = JSON.parse(atob(code));

        count = gameState.count || 0;
        perClick = gameState.perClick || 1;
        autoClicks = gameState.autoClicks || 0;
        teacher = gameState.teacher || 0;
        student = gameState.student || 0;
        role = gameState.role || null;
        hasExams = gameState.hasExams || false;
        playerName = gameState.playerName || '';
        achievementsShown = gameState.achievementsShown || [];
        prestigePoints = gameState.prestigePoints || 0;
        totalResets = gameState.totalResets || 0;
        difficulty = gameState.difficulty || 'medium';
        difficultyMultiplier = gameState.difficultyMultiplier || 1;
        clickMultiplier = gameState.clickMultiplier || 1;
        autoMultiplier = gameState.autoMultiplier || 1;
        discountLevel = gameState.discountLevel || 0;
        pClickCost = gameState.pClickCost || 1;
        pAutoCost = gameState.pAutoCost || 1;
        pPointsCost = gameState.pPointsCost || 2;
        pDiscountCost = gameState.pDiscountCost || 3;
        lang = gameState.lang || 'de';

        if (gameState.owned) {
          for (let key in gameState.owned) {
            owned[key] = gameState.owned[key];
          }
        }

        // Restore upgrade costs
        if (gameState.basicUpgrades) {
          gameState.basicUpgrades.forEach((saved, i) => {
            if (basicUpgrades[i]) {
              basicUpgrades[i].cost = saved.cost;
            }
          });
        }
        if (gameState.materialUpgrades) {
          gameState.materialUpgrades.forEach((saved, i) => {
            if (materialUpgrades[i]) {
              materialUpgrades[i].cost = saved.cost;
            }
          });
        }
        if (gameState.examUpgrades) {
          gameState.examUpgrades.forEach((saved, i) => {
            if (examUpgrades[i]) {
              examUpgrades[i].cost = saved.cost;
            }
          });
        }
        if (gameState.projectUpgrades) {
          gameState.projectUpgrades.forEach((saved, i) => {
            if (projectUpgrades[i]) {
              projectUpgrades[i].cost = saved.cost;
            }
          });
        }
        if (gameState.digitalUpgrades) {
          gameState.digitalUpgrades.forEach((saved, i) => {
            if (digitalUpgrades[i]) {
              digitalUpgrades[i].cost = saved.cost;
            }
          });
        }

        // Update UI
        document.getElementById('nameInput').value = playerName;
        document.getElementById('langSelect').value = lang;
        document.getElementById('difficultySelect').value = difficulty;

        // Update level displays
        for (let key in owned) {
          const levelEl = document.getElementById(key + 'Level');
          if (levelEl) {
            levelEl.textContent = `[${owned[key]}]`;
          }
        }

        // Show prestige shop if needed
        if (totalResets >= 1) {
          document.getElementById('prestigeShop').classList.remove('hidden');
        }

        updateLanguage();
        update();
        updateRank();
        alert('Code importiert! / Code imported!');
      } catch (e) {
        alert('UngÃ¼ltiger Code! / Invalid code: ' + e.message);
      }
    }

    // Buy Amount Selection
    function updateBuyAmountButtons() {
      document.getElementById('buy1').style.background = buyAmount === 1 ? '#4a90e2' : '#16213e';
      document.getElementById('buy5').style.background = buyAmount === 5 ? '#4a90e2' : '#16213e';
      document.getElementById('buy10').style.background = buyAmount === 10 ? '#4a90e2' : '#16213e';
    }

    document.getElementById('buy1').onclick = () => {
      buyAmount = 1;
      updateBuyAmountButtons();
      updateButtonStates();
    };

    document.getElementById('buy5').onclick = () => {
      buyAmount = 5;
      updateBuyAmountButtons();
      updateButtonStates();
    };

    document.getElementById('buy10').onclick = () => {
      buyAmount = 10;
      updateBuyAmountButtons();
      updateButtonStates();
    };

    updateBuyAmountButtons();

    // Helper function: Calculate total cost for multiple purchases with increasing costs
    function calculateTotalCost(baseCost, amount, multiplier = 1.15) {
      let total = 0;
      let currentCost = baseCost;
      for (let i = 0; i < amount; i++) {
        total += currentCost;
        currentCost = Math.ceil(currentCost * multiplier);
      }
      return total;
    }

    // Button handlers
    document.getElementById('saveBtn').onclick = () => saveGame(true);
    document.getElementById('loadBtn').onclick = loadGame;
    document.getElementById('exportBtn').onclick = exportGame;
    document.getElementById('importBtn').onclick = importGame;

    // Cheat code system
    document.getElementById('cheatBtn').onclick = () => {
      const code = document.getElementById('cheatInput').value.trim();
      const t = translations[lang];
      let points = 0;

      if (code === 'HGN') {
        points = 10000000;
      } else if (code === 'Mathe') {
        points = 10000000000;
      } else if (code === 'HerrD') {
        points = 10000000000000;
      }

      if (points > 0) {
        count += points;
        update();
        alert(t.cheatSuccess + ' +' + formatNumber(points));
        document.getElementById('cheatInput').value = '';
      } else {
        alert(t.cheatInvalid);
      }
    };

    // Allow Enter key in cheat input
    document.getElementById('cheatInput').onkeypress = (e) => {
      if (e.key === 'Enter') {
        document.getElementById('cheatBtn').click();
      }
    };

    // Auto-save every 30 seconds (silent)
    setInterval(() => saveGame(false), 30000);

    // Try to load save on startup
    window.addEventListener('load', () => {
      const saved = localStorage.getItem('schulClickerSave');
      if (saved) {
        if (confirm('Gespeicherten Spielstand laden? / Load saved game?')) {
          loadGame();
        }
      }
    });

    updateLanguage();
    update();
    updateRank();
  </script>
</body>
</html>
